
;                            MAPA DE PUNTOS PARA LAS LETRAS
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(define letras
  '(("A" (
          (0.0 2.0)
          (0.75 0.0)
          (1.5 2.0)
          (1.125 1)
          (0.375 1)))
    ("B" (
          (0 0)
          (1.125 0)
          (1.5 0.33)
          (1.5 0.66)
          (1.125 1)
          (0 1)
          (1.125 1)
          (1.5 1.33)
          (1.5 1.66)
          (1.125 2)
          (0 2)
          ))
   ("C" (
          (1.5 0.3)
          (1 0)
          (0.5 0.0)
          (0.0 0.3)
          (0.0 1.7)
          (0.5 2.0)
          (1 2)
          (1.5 1.7)
          (1 2)
          (0.5 2.0)   
          (0.0 1.7)
          (0.0 0.3)
          (0.5 0.0)
          (1 0)
          (1.5 0.3)))
   ("D" (
    (0.0 0.0)
    (0.0 2.0)
    (1.125 1.8)
    (1.5 1.6)
    (1.5 0.4)
    (1.125 0.2)
    
     ))
   ("E" (
    (0.0 0.0)
    (0.0 1.0)
    (0.0 2.0)
    (1.5 2.0)
    (0.0 2.0)
    (0.0 1.0)
    (1.0 1.0)
    (0.0 1.0)
    (0.0 0.0)
    (1.5 0.0) ))
   ("F" (
    (1.5 0.0)
    (0.0 0.0)
    (0.0 1.0)
    (1.0 1.0)
    (0.0 1.0)
    (0.0 2.0)
    (0.0 0.0) ))
   ("G"(
    (1.5 0.3)
    (1.0 0.0)  
    (0.5 0.0)
    (0.0 0.3);Capucha arriba
    (0.0 1.7)  
    (0.5 2.0)
    (1.0 2.0)
    (1.5 1.7);capucha abajo
    (1.5 1.4)
    (0.75 1.4)
    (1.5 1.4)
    (1.5 1.7)
    (1.0 2.0)
    (0.5 2.0)
    (0.0 1.7)
    (0.0 0.3)
    (0.5 0.0)
    (1.0 0.0)
    (1.5 0.3)
     ))
   ("H" (
    (0.0 0.0)
    (0.0 2.0)
    (0.0 1.0)
    (1.5 1.0)
    (1.5 0.0)
    (1.5 2.0)
    (1.5 1.0)
    (0 1.0)
    ))
   ("I" (
    (0.0 0.0)
    (1.5 0.0)
    (0.75 0.0) ;; Medio arriba
    (0.75 2.0)  ;; Medio abajo
    (0.0 2.0)
    (1.5 2.0)
    (0.75 2.0)
    (0.75 0.0)))
   ("J" (
     (0 0)
     (1.5 0)
     (1.5 1.7)
     (1 2)
     (0.5 2)
     (0 1.7)
     (0.5 2)
     (1 2)
     (1.5 1.7)
     (1.5 0)
         ))
   ("K" (
     (0 0)
     (0 1.0)
     (0 2)
     (0 1)
     (1.5 2)
     (0 1)
     (1.5 0)
     (0 1)
         ))
   ("L" (
     (0 0)
     (0 2)
     (1.5 2)
     (0 2)
         ))
   ("M"(
        (0 2)
        (0 0)
        (0.75 1)
        (1.5 0)
        (1.5 2)
        (1.5 0)
        (0.75 1)
        (0 0)
        ))
   ("N" (
         (0 2)
         (0 0)
         (1.5 2)
         (1.5 0)
         (1.5 2)
         (0 0)
         ))
   ("Ñ" (
         (0 2)
         (0 0.2)
         (1.5 2)
         (1.5 0.2)
         (1.5 0)
         (0 0)
         (1.5 0)
         (1.5 0.2)
         (1.5 2)
         (0 0.2)
         ))
   ("O"(
        (0.5 0)
        (0 0.3)
        (0 1.7)
        (0.5 2)
        (1 2)
        (1.5 1.7)
        (1.5 0.3)
        (1 0)
        ))
   ("P"(
        (0 2)
        (0 0)
        (1 0)
        (1.5 0.3)
        (1.5 0.7)
        (1 1)
        (0 1)
        ))
   ("Q"(
        (0.5 0)
        (0 0.3)
        (0 1.7)
        (0.5 2)
        (1 2)
        (0.7 1.8)
        (1.6 2)
        (1 2)
        (1.5 1.7)
        (1.5 0.3)
        (1 0)
        ))
   ("R"(
        (0 2)
        (0 0)
        (1 0)
        (1.5 0.3)
        (1.5 0.7)
        (1 1)
        (1.5 2)
        (1 1)
        (0 1)
        ))
   ("S"(
        (1.5 0.3)
        (1 0)
        (0.5 0)
        (0 0.3)
        (0 0.7)
        (0.5 1)
        (1 1)
        (1.5 1.3)
        (1.5 1.7)
        (1 2)
        (0.5 2)
        (0 1.7)
        (0.5 2)
        (1 2)
        (1.5 1.7)
        (1.5 1.3)
        (1 1)
        (0.5 1)
        (0 0.7)
        (0 0.3)
        (0.5 0)
        (1 0)
        (1.5 0.3)
        ))
   ("T"(
        (0 0)
        (1.5 0)
        (0.75 0)
        (0.75 2)
        (0.75 0)
        ))
   ("U"(
        (0 0)
        (0 1.7)
        (0.5 2)
        (1 2)
        (1.5 1.7)
        (1.5 0)
        (1.5 1.7)
        (1 2)
        (0.5 2)
        (0 1.7)

        ))
   ("V"(
        (0 0)
        (0.75 2)
        (1.5 0)
        (0.75 2)
        ))
   ("W"(
        (0 0)
        (0.375 2)
        (0.75 1)
        (1.125 2)
        (1.5 0)
        (1.125 2)
        (0.75 1)
        (0.375 2)
        ))
   ("X"(
        (0 0)
        (1.5 2)
        (0.75 1)
        (0 2)
        (0.75 1)
        (1.5 0)
        (0.75 1)
        ))
   ("Y"(
        (0 0)
        (0.75 1)
        (1.5 0)
        (0.75 1)
        (0.75 2)
        (0.75 1)
        ))
   ("Z"(
        (0 0)
        (1.5 0)
        (0 2)
        (1.5 2)
        (0 2)
        (1.5 0)
        ))
   (" " ())
   ("0"(
        (0.5 0)
        (0 0.3)
        (0 1.7)
        (0.5 2)
        (1 2)
        (1.5 1.7)
        (1.5 0.3)
        (1 0)
        ))
   ("1" ((0 0.5)
         (0.75 0)
         (0.75 2)
         (0 2)
         (1.5 2)
         (0.75 2)
         (0.75 0)))
   ("2"(
        (0 0.3)
        (0.5 0)
        (1 0)
        (1.5 0.3)
        (1.5 0.6)
        (0 2)
        (1.5 2)
        (0 2)
        (1.5 0.6)
        (1.5 0.3)
        (1 0)
        (0.5 0)
        ))
   ("3"(
        (0 0.3)
        (0.5 0)
        (1 0)
        (1.5 0.3)
        (1.5 0.6)
        (1 1)
        (1.5 1.3)
        (1.5 1.6)
        (1 2)
        (0.5 2)
        (0 1.6)
        (0.5 2)
        (1 2)
        (1.5 1.6)
        (1.5 1.3)
        (1 1)
        (1.5 0.6)
        (1.5 0.3)
        (1 0)
        (0.5 0)
        (0 0.3)
        ))
   ("4"(
        (1.125 0)
        (0 1)
        (1.125 1)
        (1.125 2)
        (1.125 1)
        (1.5 1)
        (1.125 1)
        ))
   ("5"(
        (1.5 0)
        (0 0)
        (0 1)
        (1 1)
        (1.5 1.3)
        (1.5 1.6)
        (1 2)
        (0.5 2)
        (0 1.6)
        (0.5 2)
        (1 2)
        (1.5 1.6)
        (1.5 1.3)
        (1 1)
        (0 1)
        (0 0)
        (1.5 0)
        ))
   ("6"(
        (1 0)
        (0 1.3)
        (0 1.6)
        (0.5 2)
        (1 2)
        (1.5 1.6)
        (1.5 1.3)
        (1 1)
        (0.5 1)
        (0 1.3)
        ))
   ("7"(
        (0 0)
        (1.5 0)
        (0.75 2)
        (1.5 0)
        ))
   ("8"(
        (0.5 0)
        (0 0.3)
        (0 0.7)
        (0.5 1)
        (0.75 1)
        (0.5 1)
        (0 1.3)
        (0 1.7)
        (0.5 2)
        (1 2)
        (1.5 1.7)
        (1.5 1.3)
        (1 1)
        (0.75 1)
        (1 1)
        (1.5 0.7)
        (1.5 0.3)
        (1 0)
        ))
   ("9"(
        (0.5 0)
        (0 0.3)
        (0 0.7)
        (0.5 1)
        (1 1)
        (1.5 0.7)
        (1.5 2)
        (1.5 0.3)
        (1 0)
        ))
   ("."(
        (0.75 1.98)
        (0.75 1.99)
        (0.75 2)
        (0.749 2)
        (0.749 1.99)
        (0.749 1.98)
        ))
   ("+"(
        (0.75 0.75)
        (0 0.75)
        (1.5 0.75)
        (0.75 0.75)
        (0.75 1.5)
        (0.75 0.75)
        (0.75 0)
        ))
   ("-"(
        (0 1)
        (1.5 1)
        )
    )
   ))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#|
Nombre: escalar-desplaza-construye
Descripción: Escala y desplaza una lista de puntos según un valor de escala y un desplazamiento en las coordenadas x y.
Parámetros:
- puntos: Lista de puntos a transformar, donde cada punto es una lista con dos elementos (x, y).
- x: Desplazamiento en la coordenada x.
- y: Desplazamiento en la coordenada y.
- escala: Factor de escala que se aplicará a cada coordenada de los puntos.
Devuelve:
- Lista de puntos transformados (escalados y desplazados).
Descripción de la solución:
1. La función toma una lista de puntos y aplica una transformación a cada uno de ellos.
2. Para cada punto, se multiplica la coordenada x por el factor de escala y se le suma el valor de desplazamiento en x.
3. Lo mismo se hace para la coordenada y.
4. La transformación es aplicada a todos los puntos de la lista.
Funciones auxiliares:
- Ninguna.
|#

(define (escalar-desplaza-construye puntos x y escala)
  (map (lambda (p)
         (make-posn (+ x (* escala (car p)))
                    (+ y (* escala (cadr p)))))
       puntos))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#|
Nombre: dibujar-letra
Descripción: Dibuja una letra sobre la pantalla, escalando y desplazando sus puntos según las coordenadas (x, y) proporcionadas.
Parámetros:
- letra: El carácter de la letra a dibujar.
- x: Desplazamiento en la coordenada x.
- y: Desplazamiento en la coordenada y.
- escala: Factor de escala que se aplica a los puntos de la letra.
- color: Color de la letra a dibujar.
Devuelve:
- void (Dibuja la letra en la pantalla).
Descripción de la solución:
1. La función busca los puntos correspondientes a la letra en la lista `letras`, que es una lista de asociación.
2. Si encuentra los puntos correspondientes a la letra, los escala y desplaza según el valor de `x`, `y` y `escala` utilizando la función `escalar-desplaza-construye`.
3. Luego, utiliza la función `draw-polygon` para dibujar la letra en el color especificado.
4. Si no encuentra la letra en la lista, imprime un mensaje de error.
Funciones auxiliares:
- escalar-desplaza-construye: Para transformar los puntos de la letra según la escala y el desplazamiento.
|#

(define (dibujar-letra letra x y escala color)
  (let ((puntos (assoc letra letras))) ; convierte el carácter en cadena
    (if puntos
        ((draw-polygon v1) (escalar-desplaza-construye (cadr puntos) x y escala) (make-posn 0 0) color)
        (printf "Carácter no encontrado (~a)" letra))))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#|
Nombre: dibujar-texto
Descripción: Dibuja un texto en la pantalla, donde cada letra se dibuja escalada y desplazada según los parámetros dados.
Parámetros:
- texto: La cadena de texto a dibujar.
- x: La coordenada x donde se dibujará el texto.
- y: La coordenada y donde se dibujará el texto.
- escala: Factor de escala aplicado a cada letra.
- color: Color de las letras.
Devuelve:
- void (Dibuja el texto en la pantalla).
Descripción de la solución:
1. La función toma cada letra del texto como un carácter individual usando `string->list`.
2. Para cada letra, llama a la función `dibujar-letra`, que se encarga de dibujarla con los parámetros proporcionados, como el desplazamiento (x, y), la escala y el color.
3. Después de cada letra, ajusta la posición x añadiendo un desplazamiento proporcional a la escala (para dibujar las letras en línea).
Funciones auxiliares:
- dibujar-letra: Para dibujar cada letra individualmente.
|#

(define (dibujar-texto texto x y escala color)
  (for-each (lambda (letra)
              (dibujar-letra (string letra) x y escala color) ; convierte el carácter en cadena
              (set! x (+ x (* escala 2)))) ; Ajusta la posición para cada letra
            (string->list texto)))

(define color_letras (make-rgb 1.0 1.0 1.0))

