
;                            MAPA DE PUNTOS PARA LAS LETRAS
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(define letras
  '(("A" (
          (0.0 2.0)
          (0.75 0.0)
          (1.5 2.0)
          (1.125 1)
          (0.375 1)))
    ("B" (
          (0 0)
          (1.125 0)
          (1.5 0.33)
          (1.5 0.66)
          (1.125 1)
          (0 1)
          (1.125 1)
          (1.5 1.33)
          (1.5 1.66)
          (1.125 2)
          (0 2)
          ))
   ("C" (
          (1.5 0.3)
          (1 0)
          (0.5 0.0)
          (0.0 0.3)
          (0.0 1.7)
          (0.5 2.0)
          (1 2)
          (1.5 1.7)
          (1 2)
          (0.5 2.0)   
          (0.0 1.7)
          (0.0 0.3)
          (0.5 0.0)
          (1 0)
          (1.5 0.3)))
   ("D" (
    (0.0 0.0)
    (0.0 2.0)
    (1.125 1.8)
    (1.5 1.6)
    (1.5 0.4)
    (1.125 0.2)
    
     ))
   ("E" (
    (0.0 0.0)
    (0.0 1.0)
    (0.0 2.0)
    (1.5 2.0)
    (0.0 2.0)
    (0.0 1.0)
    (1.0 1.0)
    (0.0 1.0)
    (0.0 0.0)
    (1.5 0.0) ))
   ("F" (
    (1.5 0.0)
    (0.0 0.0)
    (0.0 1.0)
    (1.0 1.0)
    (0.0 1.0)
    (0.0 2.0)
    (0.0 0.0) ))
   ("G"(
    (1.5 0.3)
    (1.0 0.0)  
    (0.5 0.0)
    (0.0 0.3);Capucha arriba
    (0.0 1.7)  
    (0.5 2.0)
    (1.0 2.0)
    (1.5 1.7);capucha abajo
    (1.5 1.4)
    (0.75 1.4)
    (1.5 1.4)
    (1.5 1.7)
    (1.0 2.0)
    (0.5 2.0)
    (0.0 1.7)
    (0.0 0.3)
    (0.5 0.0)
    (1.0 0.0)
    (1.5 0.3)
     ))
   ("H" (
    (0.0 0.0)
    (0.0 2.0)
    (0.0 1.0)
    (1.5 1.0)
    (1.5 0.0)
    (1.5 2.0)
    (1.5 1.0)
    (0 1.0)
    ))
   ("I" (
    (0.0 0.0)
    (1.5 0.0)
    (0.75 0.0) ;; Medio arriba
    (0.75 2.0)  ;; Medio abajo
    (0.0 2.0)
    (1.5 2.0)
    (0.75 2.0)
    (0.75 0.0)))
   ("J" (
     (0 0)
     (1.5 0)
     (1.5 1.7)
     (1 2)
     (0.5 2)
     (0 1.7)
     (0.5 2)
     (1 2)
     (1.5 1.7)
     (1.5 0)
         ))
   ("K" (
     (0 0)
     (0 1.0)
     (0 2)
     (0 1)
     (1.5 2)
     (0 1)
     (1.5 0)
     (0 1)
         ))
   ("L" (
     (0 0)
     (0 2)
     (1.5 2)
     (0 2)
         ))
   ("M"(
        (0 2)
        (0 0)
        (0.75 1)
        (1.5 0)
        (1.5 2)
        (1.5 0)
        (0.75 1)
        (0 0)
        ))
   ("N" (
         (0 2)
         (0 0)
         (1.5 2)
         (1.5 0)
         (1.5 2)
         (0 0)
         ))
   ("Ñ" (
         (0 2)
         (0 0.2)
         (1.5 2)
         (1.5 0.2)
         (1.5 0)
         (0 0)
         (1.5 0)
         (1.5 0.2)
         (1.5 2)
         (0 0.2)
         ))
   ("O"(
        (0.5 0)
        (0 0.3)
        (0 1.7)
        (0.5 2)
        (1 2)
        (1.5 1.7)
        (1.5 0.3)
        (1 0)
        ))
   ("P"(
        (0 2)
        (0 0)
        (1 0)
        (1.5 0.3)
        (1.5 0.7)
        (1 1)
        (0 1)
        ))
   ("Q"(
        (0.5 0)
        (0 0.3)
        (0 1.7)
        (0.5 2)
        (1 2)
        (0.7 1.8)
        (1.6 2)
        (1 2)
        (1.5 1.7)
        (1.5 0.3)
        (1 0)
        ))
   ("R"(
        (0 2)
        (0 0)
        (1 0)
        (1.5 0.3)
        (1.5 0.7)
        (1 1)
        (1.5 2)
        (1 1)
        (0 1)
        ))
   ("S"(
        (1.5 0.3)
        (1 0)
        (0.5 0)
        (0 0.3)
        (0 0.7)
        (0.5 1)
        (1 1)
        (1.5 1.3)
        (1.5 1.7)
        (1 2)
        (0.5 2)
        (0 1.7)
        (0.5 2)
        (1 2)
        (1.5 1.7)
        (1.5 1.3)
        (1 1)
        (0.5 1)
        (0 0.7)
        (0 0.3)
        (0.5 0)
        (1 0)
        (1.5 0.3)
        ))
   ("T"(
        (0 0)
        (1.5 0)
        (0.75 0)
        (0.75 2)
        (0.75 0)
        ))
   ("U"(
        (0 0)
        (0 1.7)
        (0.5 2)
        (1 2)
        (1.5 1.7)
        (1.5 0)
        (1.5 1.7)
        (1 2)
        (0.5 2)
        (0 1.7)

        ))
   ("V"(
        (0 0)
        (0.75 2)
        (1.5 0)
        (0.75 2)
        ))
   ("W"(
        (0 0)
        (0.375 2)
        (0.75 1)
        (1.125 2)
        (1.5 0)
        (1.125 2)
        (0.75 1)
        (0.375 2)
        ))
   ("X"(
        (0 0)
        (1.5 2)
        (0.75 1)
        (0 2)
        (0.75 1)
        (1.5 0)
        (0.75 1)
        ))
   ("Y"(
        (0 0)
        (0.75 1)
        (1.5 0)
        (0.75 1)
        (0.75 2)
        (0.75 1)
        ))
   ("Z"(
        (0 0)
        (1.5 0)
        (0 2)
        (1.5 2)
        (0 2)
        (1.5 0)
        ))
   (" " ())
   ("0"(
        (0.5 0)
        (0 0.3)
        (0 1.7)
        (0.5 2)
        (1 2)
        (1.5 1.7)
        (1.5 0.3)
        (1 0)
        ))
   ("1" ((0 0.5)
         (0.75 0)
         (0.75 2)
         (0 2)
         (1.5 2)
         (0.75 2)
         (0.75 0)))
   ("2"(
        (0 0.3)
        (0.5 0)
        (1 0)
        (1.5 0.3)
        (1.5 0.6)
        (0 2)
        (1.5 2)
        (0 2)
        (1.5 0.6)
        (1.5 0.3)
        (1 0)
        (0.5 0)
        ))
   ("3"(
        (0 0.3)
        (0.5 0)
        (1 0)
        (1.5 0.3)
        (1.5 0.6)
        (1 1)
        (1.5 1.3)
        (1.5 1.6)
        (1 2)
        (0.5 2)
        (0 1.6)
        (0.5 2)
        (1 2)
        (1.5 1.6)
        (1.5 1.3)
        (1 1)
        (1.5 0.6)
        (1.5 0.3)
        (1 0)
        (0.5 0)
        (0 0.3)
        ))
   ("4"(
        (1.125 0)
        (0 1)
        (1.125 1)
        (1.125 2)
        (1.125 1)
        (1.5 1)
        (1.125 1)
        ))
   ("5"(
        (1.5 0)
        (0 0)
        (0 1)
        (1 1)
        (1.5 1.3)
        (1.5 1.6)
        (1 2)
        (0.5 2)
        (0 1.6)
        (0.5 2)
        (1 2)
        (1.5 1.6)
        (1.5 1.3)
        (1 1)
        (0 1)
        (0 0)
        (1.5 0)
        ))
   ("6"(
        (1 0)
        (0 1.3)
        (0 1.6)
        (0.5 2)
        (1 2)
        (1.5 1.6)
        (1.5 1.3)
        (1 1)
        (0.5 1)
        (0 1.3)
        ))
   ("7"(
        (0 0)
        (1.5 0)
        (0.75 2)
        (1.5 0)
        ))
   ("8"(
        (0.5 0)
        (0 0.3)
        (0 0.7)
        (0.5 1)
        (0.75 1)
        (0.5 1)
        (0 1.3)
        (0 1.7)
        (0.5 2)
        (1 2)
        (1.5 1.7)
        (1.5 1.3)
        (1 1)
        (0.75 1)
        (1 1)
        (1.5 0.7)
        (1.5 0.3)
        (1 0)
        ))
   ("9"(
        (0.5 0)
        (0 0.3)
        (0 0.7)
        (0.5 1)
        (1 1)
        (1.5 0.7)
        (1.5 2)
        (1.5 0.3)
        (1 0)
        ))
   ("."(
        (0.75 1.98)
        (0.75 1.99)
        (0.75 2)
        (0.749 2)
        (0.749 1.99)
        (0.749 1.98)
        ))
   ("+"(
        (0.75 0.75)
        (0 0.75)
        (1.5 0.75)
        (0.75 0.75)
        (0.75 1.5)
        (0.75 0.75)
        (0.75 0)
        ))
   ("-"(
        (0 1)
        (1.5 1)
        )
    )
   ))

;; Función para escalar y desplazar los puntos de cada letra
(define (escalar-desplaza-construye puntos x y escala)
  (map (lambda (p)
         (make-posn (+ x (* escala (car p)))
                    (+ y (* escala (cadr p)))))
       puntos))

;; Función para dibujar una letra
(define (dibujar-letra letra x y escala color)
  (let ((puntos (assoc letra letras))) ; convierte el carácter en cadena
    (if puntos
        ((draw-polygon v1) (escalar-desplaza-construye (cadr puntos) x y escala) (make-posn 0 0) color)
        (printf "Carácter no encontrado (~a)" letra))))

;; Función para dibujar una secuencia de texto
(define (dibujar-texto texto x y escala color)
  (for-each (lambda (letra)
              (dibujar-letra (string letra) x y escala color) ; convierte el carácter en cadena
              (set! x (+ x (* escala 2)))) ; Ajusta la posición para cada letra
            (string->list texto)))

(define color_letras (make-rgb 1.0 1.0 1.0))

;; Prueba de la función con la cadena "AB-"

