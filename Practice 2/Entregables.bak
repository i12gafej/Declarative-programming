;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 3.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#|
Nombre:
   provincias
Objetivo:
   Indica el código de las provincias de Andalucía.
Parámetros:
 - nombre: nombre de la provincia.
Resultado:
   Código numérico de la provincia.
Descripción de la solucion:
   Los códigos de las provincias son:
   o Almería: 04
   o Cádiz: 11
   o Córdoba: 14
   o Granada: 18
   o Huelva: 21
   o Jaén: 23
   o Málaga: 29
   o Sevilla: 41
Funciones auxiliares a las que llama:
   ninguno
|#


(define (provincias nombre)
    (case nombre
      (("Almería") "04")
      (("Cádiz") "11")
      (("Córdoba") "14")
      (("Granada") "18")
      (("Huelva") "21")
      (("Jaén") "23")
      (("Málaga") "29")
      (("Sevilla") "41")
      (else (display "Nombre incorrecto") (newline))
    )
  )

;; (provincias "Almería")
;; (provincias "Cádiz")
;; (provincias "Córdoba")
;; (provincias "Huelva")
;; (provincias "Granada")
;; (provincias "Jaén")
;; (provincias "Málaga")
;; (provincias "Castellón")
;; (provincias "sevilla")

#|
Resultado:
"04"
"11"
"14"
"21"
"18"
"23"
"29"
Nombre incorrecto
Nombre incorrecto

|#


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 4.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#|
Nombre:
   letra-dni
Objetivo:
   Dado un número de DNI, se devuelve la letra.
Parámetros:
 - n: número del DNI.
Resultado:
   Letra.
Descripción de la solucion:
  La equivalencia del resto con la letra es la siguiente:
   0 -> T          13 -> J
   1 -> R          14 -> Z
   2 -> W          15 -> S
   3 -> A          16 -> Q
   4 -> G          17 -> V
   5 -> M          18 -> H
   6 -> Y          19 -> L
   7 -> F          20 -> C
   8 -> P          21 -> K
   9 -> D          22 -> E
   10 -> X          
   11 -> B          
   12 -> N

Funciones auxiliares a las que llama:
   ninguno
|#

(define (letra-dni n)
    (case (modulo n 23)
       ((0) "T")
       ((1) "R")
       ((2) "W")
       ((3) "A")
       ((4) "G")
       ((5) "M")
       ((6) "Y")
       ((7) "F")
       ((8) "P")
       ((9) "D")
       ((10) "X")
       ((11) "B")
       ((12) "N")
       ((13) "J")
       ((14) "Z")
       ((15) "S")
       ((16) "Q")
       ((17) "V")
       ((18) "H")
       ((19) "L")
       ((20) "C")
       ((21) "K")
       ((22) "E")
    )
  )

;; (letra-dni 46072145)
;; (letra-dni 46072154)
;; (letra-dni 46072147)
;; (letra-dni 46072150)

#|
Resultado:
"V"
"A"
"L"
"E"
|#

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 5.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#|
Nombre:
   angulo
Objetivo:
   Dados 4 puntos P 1 , P 2 , P 3 y P 4 y calcule el ángulo que forman
   los vectores definidos por dichos puntos.
Parámetros:
 - x1: coordenada x del punto P1.
 - y1: coordenada y del punto P1.
 - x2: coordenada x del punto P2.
 - y2: coordenada y del punto P2.
 - x3: coordenada x del punto P3.
 - y3: coordenada y del punto P3.
 - x4: coordenada x del punto P4.
 - y4: coordenada y del punto P4.
Resultado:
   Ángulo en radianes.
Descripción de la solucion:
  Para dos vectores tangentes, el ángulo es pi / 2.
  Para dos vectores paralelos, el ángulo es 0.
  Para el resto de vectores, el angulo es mayor a 0. 
Funciones auxiliares a las que llama:
   ninguno
|#

(define (angulo x1 y1 x2 y2 x3 y3 x4 y4)
  (let
     (
       (u1 (- x2 x1))
       (u2 (- y2 y1))
       (v1 (- x4 x3))
       (v2 (- y4 y3))
     )
    
     (acos (/
              (+ (* u1 v1) (* u2 v2))
              (* (sqrt (+ (sqr u1) (sqr u2))) (sqrt (+ (sqr v1) (sqr v2)))))
     )
  )
)

;; (angulo 0 0 3 0 0 1 3 1)
;; (angulo 0 0 3 0 0 1 0 0)
;; (angulo 0 3 3 7 8 9 1 1)

#|
Resultados:
0
1.5707963267948966
3.0662637627614506
|#

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 6.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#|
Nombre:
   posicionRelativaRectas
Objetivo:
   Dados los coeficientes de dos rectas, se determina la posición relativa de las rectas.
Parámetros:
 - a1: coeficiente a de la recta 1.
 - b1: coeficiente b de la recta 1.
 - c1: coeficiente c de la recta 1.
 - a2: coeficiente a de la recta 2.
 - b2: coeficiente b de la recta 2.
 - c2: coeficiente c de la recta 2.
Resultado:
   Posicion relativa de las rectas.
Descripción de la solucion:
  Iguales: si son la misma recta proporcional (a1/a2 = b1/b2 = c1/c2)
  Paralelas: si son la misma recta desplazada en el eje x (a1/a2 = b1/b2 != c1/c2)
  Perpendiculares: si son secantes con 90º (a1/a2 = -b1/b2)
  Secantes: si se cortan sin tener 90º (a1/a2 != b1/b2)
Funciones auxiliares a las que llama:
   ninguno
|#

(define (posicionRelativaRectas a1 b1 c1 a2 b2 c2)
  (let
    (
      (determinante (- (* a1 b2) (* a2 b1)))
    )
    (cond
      ((= (* a1 a2) (- (* b1 b2))) "Perpendiculares")
      ((and (= determinante 0)
            (not (= (/ c1 a1) (/ c2 a2))))
       "Paralelas")
      ((and (= (/ a1 a2) (/ b1 b2))
            (= (/ c1 c2) (/ b1 b2)))
       "Iguales")
      ((not (= determinante 0)) "Secantes")
    )
  )
)


;; Ejemplo de iguales
;; (posicionRelativaRectas 1 1 1 1 1 1)
;; Ejemplo de paralelas
;; (posicionRelativaRectas 1 1 1 1 1 2)
;; Ejemplo de secantes
;; (posicionRelativaRectas 1 1 1 2 1 2)
;; Ejemplo de perpendiculares
;; (posicionRelativaRectas 1 1 1 -1 1 1)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 7.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#|
Nombre:
   posicionRelativaCircunferencias
Objetivo:
   Dadas las coordenadas de los centros y los radios, se determina la posición relativa de las circunferencias.
Parámetros:
   - x1: coordenada x del centro de la circunferencia 1.
   - y1: coordenada y del centro de la circunferencia 1.
   - r1: radio de la circunferencia 1.
   - x2: coordenada x del centro de la circunferencia 2.
   - y2: coordenada y del centro de la circunferencia 2.
   - r2: radio de la circunferencia 2.
Resultado:
   Posicion relativa de las circunferencias.
Descripción de la solucion:
   Iguales [1]: si son la misma circunferencia (x1 = x2 y y1 = y2 y r1 = r2)
   Concentricas [2]: si tienen el mismo centro (x1 = x2 y y1 = y2 y r1 != r2)
   Tangentes por dentro [3]: si la distancia entre los centros es menor a la diferencia de los radios
   Tangentes por fuera [4]: si la distancia entre los centros es mayor a la suma de los radios
   Exteriores [5]: si la distancia entre los centros es mayor a la suma de los radios
   Interiores [6]: si la distancia entre los centros es menor a la diferencia de los radios
   Secantes por dentro [7]: si la distancia entre los centros es menor a la suma de los radios
   Secantes por fuera [8]: si la distancia entre los centros es mayor a la diferencia de los radios
Funciones auxiliares a las que llama:
   ninguna
|#

(define (posicionRelativaCircunferencias x1 y1 r1 x2 y2 r2)
  (let
    (
      (distanciaCentros (sqrt (+ (sqr (- x2 x1)) (sqr (- y2 y1)))))
    )
    (cond
      ((and (= x1 x2) (= y1 y2) (= r1 r2)) 1)
      ((and (= x1 x2) (= y1 y2) (not (= r1 r2))) 2)
      ((= distanciaCentros (+ r1 r2)) 3)
      ((= distanciaCentros (abs (- r1 r2))) 4)
      ((> distanciaCentros (+ r1 r2)) 5)
      ((< distanciaCentros (abs (- r1 r2))) 6)
      ((and (< distanciaCentros (+ r1 r2)) (> distanciaCentros (abs (- r1 r2)))) 7)
    )
  )
)


;; Ejemplo de iguales
;; (posicionRelativaCircunferencias 0 0 1 0 0 1)
;; Ejemplo de concentricas
;; (posicionRelativaCircunferencias 0 0 1 0 0 2)
;; Ejemplo de tangentes por fuera
;; (posicionRelativaCircunferencias 0 0 1 3 0 2)
;; Ejemplo de tangentes por dentro
;; (posicionRelativaCircunferencias 0 0 1 1 0 2)
;; Ejemplo de exteriores
;; (posicionRelativaCircunferencias 0 0 1 4 0 1)
;; Ejemplo de interiores
;; (posicionRelativaCircunferencias 0 0 1 0 1 4)
;; Ejemplo de secantes
;; (posicionRelativaCircunferencias 0 0 1 2 0 2)



;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 8.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 8.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#|
Nombre:
   posicionPunto
Objetivo:
   Determinar la posición de un punto (x, y) en relación con un círculo, un cuadrado y un rombo.
Parámetros:
 - x: Coordenada x del punto.
 - y: Coordenada y del punto.
Resultado:
   Un valor indicando la posición relativa del punto (pertenece a la circunferencia o a los lados del cuadrado/rombo, dentro del círculo, dentro del cuadrado, etc.)
Descripción de la solución:
   Según la posición del punto, se calcula la categoría a la que pertenece el punto. Las sitancias utilizadas son la D1 o distancia de Manhattan, D2 o distancia Euclidea, y Dmax
   o distancia de ajedrez. Si la distancia entre el punto y el centro de cada figura es mayor a uno, el punto  está fuera de la figura. Si es menor o igual a 1, el punto está dentro
   de la figura. Combinando esta operación entre los distintos tipos de distancia, obtenemos un resultado. 
   Categorías:
 - 1: El punto pertenece a la circunferencia o a los lados del cuadrado/rombo
 - 2: El punto está dentro del círculo y fuera del cuadrado
 - 3: El punto está dentro del círculo y del cuadrado
 - 4: El punto está dentro del cuadrado y fuera del círculo y del rombo
 - 5: El punto está dentro del cuadrado y del rombo
 - 6: El punto está dentro del rombo y fuera del cuadrado
 - 7: En otro caso
Funciones auxiliares a las que llama:
   Dmax, D1, D2
|#

;; Distancia Ajedrez
(define (Dmax x1 y1 x2 y2)
   (max (abs (- x2 x1)) (abs (- y2 y1)))
)
;; Distancia Manhattan
(define (D1 x1 y1 x2 y2)
   (+ (abs (- x2 x1)) (abs (- y2 y1)))
)
;; Distancia Euclidea
(define (D2 x1 y1 x2 y2)
   (sqrt (+ (expt (- x2 x1) 2) (expt (- y2 y1) 2)))
)

(define (posicionPunto x y)
  (cond
    ;; Dentro de la circunferencia y fuera del cuadrado
    ((and (<= (D2 x y -1 0) 1) (> (D1 x y 0 0) 1)) 2)
    ;; Dentro de la circunferencia y del cuadrado 
    ((and (<= (D2 x y -1 0) 1) (<= (D1 x y 0 0) 1)) 3)
    ;; Dentro de la circunferencia o en los lados del rombo o cuadrado. Se pone aquí por ser más restrintiva
    ((or (< (D2 x y -1 0) 1) (or (= (D1 x y 0 0) 1) (= (Dmax x y 1 0) 1))) 1)
    ;; Dentro del cuadrado y fuera del circulo y del rombo
    ((and (> (D2 x y -1 0) 1) (<= (D1 x y 0 0) 1) (> (Dmax x y 1 0) 1)) 4)
    ;; Dentro del cuadrado y del rombo
    ((and (<= (D1 x y 0 0) 1) (<= (Dmax x y 1 0) 1)) 5)
    ;; Fuera del cuadrado y dentro del rombo
    ((and (> (D1 x y 0 0) 1) (< (Dmax x y 1 0) 1)) 6)
    ;; Otro
    (else 7)
  )
)

;; Ejemplo 1: El punto pertenece a la circunferencia o a los lados del cuadrado/rombo
;;(posicionPunto 1 0)

;; Ejemplo 2: El punto está dentro del círculo y fuera del cuadrado
;;(posicionPunto -1.1 0)

;; Ejemplo 3: El punto está dentro del círculo y del cuadrado
;;(posicionPunto -0.5 0)

;; Ejemplo 4: El punto está dentro del cuadrado y fuera del círculo y del rombo
;;(posicionPunto 0 0.7)

;; Ejemplo 5: El punto está dentro del cuadrado y del rombo
;;(posicionPunto 0.5 0)

;; Ejemplo 6: El punto está dentro del rombo y fuera del cuadrado
;;(posicionPunto 1.5 0)

;; Ejemplo 7: En otro caso
;;(posicionPunto 2 2)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  
;; 9.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#|

Nombre:
   tipoTrianguloPorAngulos
Objetivo:
   Dadas las coordenadas de los vértices de un triángulo y devuelva el
valor que le corresponde según su tipo.
Parámetros:
 - x1: coordenada x del vértice 1.
 - y1: coordenada y del vértice 1.
 - x2: coordenada x del vértice 2.
 - y2: coordenada y del vértice 2.
 - x3: coordenada x del vértice 3.
 - y3: coordenada y del vértice 3.
Resultado:
   Tipo de triángulo
Descripción de la solucion:
   Dados tres puntos desordenados, primero se calcula la distancia entre los puntos para determinar si es un triángulo. Luego se calcula el ángulo entre los puntos para determinar
   el tipo de triángulo. Si la suma de los ángulos es igual a 180º, es un triángulo. Si uno de los ángulos es igual a 90º, es un triángulo rectángulo. Si todos los ángulos son menores
   a 90º, es un triángulo acutángulo. Si uno de los ángulos es mayor a 90º y menor a 180º, es un triángulo obtusángulo. Si los tres vértices están alineados, es un triángulo nulo.

 - Recto: tiene un ángulo de 90º, es decir, p/2 radianes.
 - Acutángulo: todos sus ángulos son menores que 90º.
 - Obtusángulo: tiene un ángulo mayor de 90º y menor de 180º.
 - Nulo: los tres vértices están alineados.

Funciones auxiliares a las que llama:
   
|#



(define (tipoTrianguloPorAngulos x1 y1 x2 y2 x3 y3)
  ;; Let secuencial
  (let* (
         ;; Variables locales
         (angulo1 (angulo x1 y1 x2 y2 x1 y1 x3 y3)) 
         (angulo2 (angulo x2 y2 x1 y1 x2 y2 x3 y3)) 
         (angulo3 (angulo x3 y3 x1 y1 x3 y3 x2 y2)) 
         (sumaAngulos (+ angulo1 angulo2 angulo3))
        )
    (cond
       ;; Si dos ángulos son cercanos a 0 y el otro cercano a pi (180o)
      ((or (< angulo1 1e-6) (< angulo2 1e-6) (< angulo3 1e-6)) "Triángulo nulo")
      ;; Verificar si es un triángulo rectángulo (uno de los ángulos es 90o o pi/2)
      ((or (and (> angulo1 (- (/ pi 2) 1e-6)) (< angulo1 (+ (/ pi 2) 1e-6)))
           (and (> angulo2 (- (/ pi 2) 1e-6)) (< angulo2 (+ (/ pi 2) 1e-6)))
           (and (> angulo3 (- (/ pi 2) 1e-6)) (< angulo3 (+ (/ pi 2) 1e-6))))
       "Triángulo rectángulo")
      ;; Verificar si es un triángulo obtusángulo (un ángulo mayor de 90o)
      ((or (> angulo1 (/ pi 2)) (> angulo2 (/ pi 2)) (> angulo3 (/ pi 2)))
       "Triángulo obtusángulo")
      ;; Si todos los ángulos son menores a 90o, es un triángulo acutángulo
      (else "Triángulo acutángulo")
    )
  )
)

;; Prueba con un triángulo rectángulo
;;(tipoTrianguloPorAngulos 3 0 0 0 0 4)  

;; Prueba con un triángulo donde los puntos están alineados
;;(tipoTrianguloPorAngulos 0 0 1 1 2 2)  

;; Prueba con un triángulo acutángulo
;;(tipoTrianguloPorAngulos 0 0 2 1 1 2)  

;;Prueba con un triangulo obtusangulo
;;(tipoTrianguloPorAngulos 0 0 -2 1 2 0)


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  
;; 10.a.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#|

Nombre:
   ladosParalelos?
Objetivo:
   Dados los puntos P1, P2, P3 Y P4, devuelve si las rectas r = P1P2 y s = P3P4 son
   paralelas.
Parámetros:
 - x1: coordenada x del punto P1.
 - y1: coordenada y del punto P1.
 - x2: coordenada x del punto P2.
 - y2: coordenada y del punto P2.
 - x3: coordenada x del punto P3.
 - y3: coordenada y del punto P3.
 - x4: coordenada x del punto P4.
 - y4: coordenada y del punto P4.
Resultado:
   Booleano. 
Descripción de la solucion:
   Primero, calcula las pendientes, y luego las compara. Si son la misma pendiente
   devuelve verdadero.
Funciones auxiliares a las que llama:
   pendiente
|#

;; Función secundaria para calcular la pendiente dados 2 puntos
 (define (pendiente x1 y1 x2 y2)
   (if (= x1 x2)
      'infinito ;; Si son rectas paralelas, devuelve infinito
      (/ (- y2 y1) (- x2 x1))) ;; Si no, se devuelve el valor de la pendiente
   )

(define (ladosParalelos? x1 y1 x2 y2 x3 y3 x4 y4)
  (let
    (
     ;; Variables locales
     (m1 (pendiente x1 y1 x2 y2))
     (m2 (pendiente x3 y3 x4 y4))
     )
  (cond
    ((and (eq? m1 'infinito) (eq? m2 'infinito)) #t) ;; Si las pendientes son las dos infinitas
    ((and (and (number? m1) (number? m2)) (= m1 m2)) #t) ;; O iguales, es verdad
    (else #f) ;; Si no es falso
    )
  )
)

;;(if (ladosParalelos? 0 0 0 -4 1 1 1 -4) "Son paralelos")
;;(if (ladosParalelos? 0 0 1 2 1 0 2 2) "Son paralelos")
;;(if (not (ladosParalelos? 0 0 1 0 0 0 1 1)) "No son paralelos")

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  
;; 10.b.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#|

Nombre:
   perpendiculares?
Objetivo:
   Dados los puntos P1, P2, P3 Y P4, devuelve si las rectas r = P1P2 y s = P3P4 son
   perpendiculares.
Parámetros:
 - x1: coordenada x del punto P1.
 - y1: coordenada y del punto P1.
 - x2: coordenada x del punto P2.
 - y2: coordenada y del punto P2.
 - x3: coordenada x del punto P3.
 - y3: coordenada y del punto P3.
 - x4: coordenada x del punto P4.
 - y4: coordenada y del punto P4.
Resultado:
   Booleano. 
Descripción de la solucion:
   Primero, calcula las pendientes, y luego las compara. Si son las pendientes
   son opuestas devuelve verdadero (que sean 0 o infinito, o que el producto seaa igual a -1).
Funciones auxiliares a las que llama:
   pendiente
|#
(define (perpendiculares? x1 y1 x2 y2 x3 y3 x4 y4)
  (let
    (
     ;; Variables locales
     (m1 (pendiente x1 y1 x2 y2))
     (m2 (pendiente x3 y3 x4 y4))
     )
  (cond
    ((or (and (eq? m1 'infinito) (<= m2 1e-6))
         (and (eq? m2 'infinito) (<= m1 1e-6))) #t) ;; Si las pendientes son paralelas al eje x e y (infinito y 0)
    ((and (number? m1) (number? m2) (= (* m1 m2) -1)) #t) ;; Si el producto de las pendientes es -1 
    (else #f) ;; Si no es falso
    )
  )
)

;;(if (perpendiculares? 0 0 1 0 0 0 0 1) "Son perpendiculares")
;;(if (perpendiculares? 0 0 1 2 -2 1 0 0) "Son perpendiculares")
;;(if (not (perpendiculares? 0 0 1 0 0 1 1 1)) "No son perpendiculares")



;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  
;; 11.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#|

Nombre:
   areaTrapecio
Objetivo:
   Calcular el área de un trapecio dados los vértices de sus cuatro puntos, sin necesidad de que los puntos estén ordenados. La función identifica las bases paralelas del trapecio y calcula el área usando la fórmula estándar.
Parámetros:
 - x1: coordenada x del punto P1.
 - y1: coordenada y del punto P1.
 - x2: coordenada x del punto P2.
 - y2: coordenada y del punto P2.
 - x3: coordenada x del punto P3.
 - y3: coordenada y del punto P3.
 - x4: coordenada x del punto P4.
 - y4: coordenada y del punto P4.
Resultado:
   Devuelve el área del trapecio. Si no se encuentran lados paralelos, la función devuelve 0.
Descripción de la solucion:
   1. Calcula los 6 posibles lados que pueden formarse entre los 4 puntos dados, utilizando la fórmula de la distancia euclidiana.
   2. Identifica cuáles de los lados son paralelos usando la función `ladosParalelos?`. Busca combinaciones de dos lados paralelos y los define como las bases del trapecio.
   3. Calcula la altura del trapecio como la distancia perpendicular entre las dos bases paralelas.
   4. Aplica la fórmula del área del trapecio:  A = (B_1 + B_2)/2, donde B_1 y B_2 son las longitudes de las bases y h es la altura.
Funciones auxiliares a las que llama:
   D2, ladosParalelos?, pendiente, distanciaPuntoRecta, areaTrapecioLetVertices
|#

;; Función Auxiliar distanciaPuntoRecta
(define (distanciaPuntoRecta x0 y0 x1 y1 x2 y2)
  (let ((a (- y2 y1))
        (b (- x1 x2))
        (c (- (* x2 y1) (* x1 y2))))
    (/ (abs (+ (* a x0) (* b y0) c)) (sqrt (+ (expt a 2) (expt b 2))))))

;; Función de la práctica 1 areaTrapecioLetVertices
(define (areaTrapecioLetVertices x0 y0 x1 y1 x2 y2 x3 y3)
  (let ((base1 (D2 x0 y0 x1 y1))
        (base2 (D2 x3 y3 x2 y2))
        (h (distanciaPuntoRecta x3 y3 x0 y0 x1 y1)))
    (* (/ (+ base1 base2) 2.) h)))

(define (areaTrapecio x1 y1 x2 y2 x3 y3 x4 y4)
  (let ((paralelo12-34 (ladosParalelos? x1 y1 x2 y2 x3 y3 x4 y4))
        (paralelo13-24 (ladosParalelos? x1 y1 x3 y3 x2 y2 x4 y4))
        (paralelo14-23 (ladosParalelos? x1 y1 x4 y4 x2 y2 x3 y3)))
    (cond
      (paralelo12-34 (areaTrapecioLetVertices x1 y1 x2 y2 x3 y3 x4 y4))
      (paralelo13-24 (areaTrapecioLetVertices x1 y1 x3 y3 x2 y2 x4 y4))
      (paralelo14-23 (areaTrapecioLetVertices x1 y1 x4 y4 x2 y2 x3 y3))
      )))

;; Ejemplo 1: Trapecio con bases paralelas horizontales
(areaTrapecio 0 0 4 0 3 3 -1 3)
;; Salida esperada: 12

;; Ejemplo 2: Trapecio rotado, con bases paralelas inclinadas
(areaTrapecio 0 0 3 3 6 3 9 0)
;; Salida esperada: 18

;; Ejemplo 3: Trapecio donde los puntos no están en orden
(areaTrapecio 1 1 4 1 3 5 0 5)
;; Salida esperada: 16

;; Ejemplo 4: Trapecio muy angosto
(areaTrapecio 0 0 2 0 1 0.1 1 -0.1)
;; Salida esperada: 0.2

;; Ejemplo 5: Caso inválido (no se forma un trapecio)
(areaTrapecio 0 0 1 1 2 2 3 3)
;; Salida esperada: No es un trapecio válido


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  
;; 12.
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#|

Nombre:
   areaRombo
Objetivo:
   Calcular el área de un rombo dados los vértices de sus cuatro puntos, sin necesidad de que los puntos estén ordenados. La función identifica las diagonales perpendiculares del rombo y calcula el área usando la fórmula estándar.
Parámetros:
 - x1: coordenada x del punto P1.
 - y1: coordenada y del punto P1.
 - x2: coordenada x del punto P2.
 - y2: coordenada y del punto P2.
 - x3: coordenada x del punto P3.
 - y3: coordenada y del punto P3.
 - x4: coordenada x del punto P4.
 - y4: coordenada y del punto P4.
Resultado:
   Devuelve el área del rombo. Si la fiura indicada no es un rombo, la función devuelve 0.
Descripción de la solucion:
   1. Calcula las 6 posibles diagonales que pueden formarse entre los 4 puntos dados, utilizando la fórmula de la distancia euclidiana.
   2. Identifica cuáles de las diagonales son perpendiculares usando la función `perpendiculares?`. Busca combinaciones de las diagonales perpendiculares y los define como las diagonales del rombo.
   4. Aplica la fórmula del área del rombo:
Funciones auxiliares a las que llama:
   D2, perpendiculares?, pendiente, distanciaPuntoRecta, areaRomboLetVertices
|#